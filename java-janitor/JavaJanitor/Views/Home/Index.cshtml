<div class="jumbotron">
    <h1>Virtual Terry Tate</h1>
    <p class="lead">Genscape believes in a well-caffinated work-force.</p>
    <p>In order to ensure that all of our employees have access to a consistent source of coffee, we've decided to implement this virtual version of our very own cofee enforcer, Terry Tate.</p>
</div>
<div class="row">
    <div class="carafe col-md-12 @ViewBag.CarafeState">
        <h2 class="carafe-state">@ViewBag.CarafeState</h2>
        <dl class="dl-horizontal">
            <dt>Last Updated:</dt>
            <dd class="carafe-last-updated">@ViewBag.CarafeLastUpdated</dd>
        </dl>
    </div>
</div>
<div class="row">
    <div class="col-md-12 wall-of-shame">
        <h2>Wall of Shame</h2>
    </div>
</div>
@section scripts {
    <script src="~/Scripts/jquery.signalR-2.2.0.min.js"></script>
    <script src="~/signalr/hubs"></script>
    <script src="~/Scripts/handlebars.runtime-v3.0.0.js"></script>
    <script>
        $(function () {
            var source = $('#thumbnail-template').html();
            var thumbnailTemplate = Handlebars.compile(source);
            var tateHub = $.connection.tateHub;

            tateHub.client.sendCarafeState = function (status, timestamp) {
                $('.carafe').removeClass('Empty Full').addClass(status);
                $('.carafe-state').empty().text(status);
            };

            tateHub.client.sendShame = function (name, imageGuid) {
                $('.wall-of-shame').find('h2').after(thumbnailTemplate({name: name, guid: imageGuid}));
            };

            $.connection.hub.start().done(function () { });
        });
    </script>
    <script id="thumbnail-template" type="text/x-handlebars-template">
        <a href="#" class="thumbnail">
            <figure>
                <img src="http://genscape-java-janitor.azurewebsites.net/images/{{guid}}">
                <figcaption>{{name}}</figcaption>
            </figure>
        </a>
    </script>
}